/*! frontal 12-12-2013 10:33:25 */
!function(a){a(["jquery"],function(a){function b(b){a(document).on("click",":not(form)[type=submit], :not(form)[data-f-ajaxify]",c).on("submit","form[data-f-ajaxify]",c).on("mouseenter",":not(form)[type=submit], :not(form)[data-f-ajaxify]",c),a.extend(k,b)}function c(b){var c=b.currentTarget,e=a(c);if((!e.is("[type=submit]")||e.parents("form[data-f-ajaxify]")[0])&&("mouseenter"!=b.type||e.attr("data-f-hover"))){var h=e.attr("data-f-ajaxify")||null,i=e.attr("data-f-href")||e.attr("href")||e.attr("action"),j=e.attr("data-f-loading")||null,l=e.attr("data-f-uniq")||null,m=e.attr("data-f-confirm")||null,n=e.attr("data-f-stop")||null,o=e.attr("data-f-toggle")||null,p=null,q=e.attr("data-f-method")||null,r=b.type;if(e.is("[type=submit]")&&(p=e.parents("form[data-f-ajaxify]").first(),i=i||p.attr("action"),h=p.attr("data-f-ajaxify"),m=m||e.attr("data-f-confirm")),"0"===h)return b.preventDefault(),void 0;if(i){if(n)return b.preventDefault(),void 0;if(m&&!window.confirm(m))return b.preventDefault(),void 0;if(e.is("[type=submit]"))return p.append(a('<input type="hidden" class="js-injected"/>').attr({name:e.attr("name")||"",value:e.val()||""})),f(e[0]),void 0;q=e.is("form")?"post":q||"get",f(c,j),e.attr("data-f-ajaxify","0");var s;e.is("form")?(s=e.serializeArray(),s.push({name:"__ajax__",value:1})):s={__ajax__:1};var t={url:i,type:q,data:s,xhrFields:{withCredentials:!0}},u=function(a){if(d(a),e.is("form")&&o&&a.success){{e.find(".js-loading")}e.find("[type=submit]").attr("data-f-stop","").filter(".js-loading").attr("data-f-stop","1")}},v=function(){e.attr("data-f-ajaxify",l?null:"1"),e.is("form")&&e.find(".js-injected").remove(),g(c),"mouseenter"==r&&e.trigger("mouseenter")};k.onBeforeAjax?k.onBeforeAjax(t,u,v):a.ajax(t).done(u).always(v),b.preventDefault()}}}function d(b){if("string"==typeof b&&(b=JSON.parse(b)),"undefined"!=typeof b.actions){for(var c=a.isArray(b.actions)?b.actions:[b.actions],d=null,e=null,f=0;f<c.length;f++)if(e=c[f],a.fn[e.method])d=e.selector?a(e.selector):d,d=d?d[e.method].apply(d,e.args):a()[e.method].apply(a,e.args);else if(a[e.method])a[e.method].apply(a,[e.args]);else switch(e.method){case"redirect":document.location.href=e.args}a(document).trigger("contentchange")}}function e(b){a.get(b,function(a){d(a)})}function f(b,c){return c&&"spinner"==c?(i||(i=a('<div class="spinner"><div class="spinner-inner"><div class="spinner-icn"></div></div></div>').appendTo("body")),clearInterval(h),i.show(),h=setInterval(function(){return i.is(":visible")?(a(".spinner-icn",i).css("top",-40*j+"px"),j=(j+1)%12,void 0):(clearInterval(h),void 0)},66),void 0):b?(a(b).addClass("js-loading"),void 0):void 0}function g(b){b&&a(b).removeClass("js-loading").find(".js-loading").removeClass("js-loading"),i&&i.hide()}var h,i=null,j=1,k={};return{ajaxify:e,listen:b,handleResponse:d}})}("function"==typeof define&&define.amd?define:function(a,b){"undefined"!=typeof module&&module.exports?module.exports=b(require(a[0])):window.frontal=b(window.jQuery)});